<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QR Demo Scanner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white min-h-screen flex flex-col items-center justify-center px-4">

  <h1 class="text-xl font-bold mb-4">ðŸ“· QR Code Demo Scanner</h1>

  <video
    id="video"
    class="w-full max-w-sm rounded-lg border border-zinc-700"
    autoplay
    muted
    playsinline>
  </video>

  <div
    id="output"
    class="mt-6 p-4 rounded-lg bg-zinc-800 text-center text-lg hidden">
  </div>

<script>
const video = document.getElementById("video");
const output = document.getElementById("output");

async function startScanner() {
  // Check support
  if (!("BarcodeDetector" in window)) {
    alert("BarcodeDetector API not supported on this browser.");
    return;
  }

  // Start camera
  const stream = await navigator.mediaDevices.getUserMedia({
    video: { facingMode: "environment" }
  });
  video.srcObject = stream;

  const detector = new BarcodeDetector({ formats: ["qr_code"] });

  async function scanLoop() {
    try {
      const codes = await detector.detect(video);
      if (codes.length > 0) {
        output.innerText = `QR Detected:\n\n${codes[0].rawValue}`;
        output.classList.remove("hidden");
      }
    } catch (e) {
      // silently ignore
    }

    requestAnimationFrame(scanLoop);
  }

  scanLoop();
}

startScanner();
</script>

</body>
</html>
